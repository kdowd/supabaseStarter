<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
        href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII="
        rel="icon" type="image/x-icon" />

    <link rel="stylesheet" href="./main.css" />



    <script type="importmap">
      {
        "imports": {
          "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js"
        }
      }
    </script>

    <script type="module" src="./js/main.js"></script>

    <script type="module">
        import { supabase } from "./js/main.js";
        console.log(supabase);
        const form = document.querySelector(".signup-form");

        async function handleSubmit(e) {
            e.preventDefault();
            console.log("submitting");

            const { data, error } = await supabase.auth.signInWithOtp({
                email: 'kevin.dowd@gmail.com',
                options: {
                    emailRedirectTo: 'http://127.0.0.63:5500/redirect.html'
                }
            });
            if (data) {
                window.pigg = data;
            }

            if (error) {
                alert(error.message);
            }

        }

        form?.addEventListener("submit", handleSubmit);

    </script>

    <script type="module">

        import { supabase } from "./js/main.js";
        window.addEventListener("load", async () => {
            console.log("Get Users");


            const { data: { users }, error } = await supabaseAdmin.auth.admin.listUsers({
                page: 1,
                perPage: 1000 // Adjust perPage as needed (max is 1000)
            });

            if (error) {
                console.error('Error fetching users:', error.message);
            } else {
                console.log('Users:', users);
            }

        })
    </script>


</head>

<body>
    <h1>Users</h1>


</body>

</html>