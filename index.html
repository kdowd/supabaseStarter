<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
        href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII="
        rel="icon" type="image/x-icon" />

    <link rel="stylesheet" href="./main.css" />




    <script type="importmap">
      {
        "imports": {
          "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js"
        }
      }
    </script>

    <script type="module" src="./js/main.js"></script>

    <script type="module">
        import { supabase } from "./js/main.js";
        console.log(supabase);
        const form = document.querySelector(".signup-form");

        async function handleSubmit(e) {
            e.preventDefault();
            console.log("submitting");

            const { data, error } = await supabase.auth.signInWithOtp({
                email: 'kevin.dowd@gmail.com',
                options: {
                    emailRedirectTo: 'http://127.0.0.63:5500/redirect.html'
                }
            });
            if (data) {
                window.pigg = data;
            }

            if (error) {
                alert(error.message);
            }

        }

        form?.addEventListener("submit", handleSubmit);

    </script>

    <script type="module">

        import { supabase } from "./js/main.js";
        window.addEventListener("load", async () => {
            const { data: { user } } = await supabase.auth.getUser();

            console.log("User =", user);

        })
    </script>


</head>

<body>
    <h1>Hello</h1>
    <form action="" class="signup-form">
        <input type="email" placeholder="enter email" autocomplete="email">
        <button type="submit">submit</button>
    </form>
    <h2>Magic Link</h2>

    <p>Follow this link to login:</p>
    <p><a href="{{ .ConfirmationURL }}">Log In</a></p>
    <blockquote>
        Lorem ipsum, dolor sit amet consectetur adipisicing elit. Expedita deserunt ratione mollitia quo modi placeat?
        Aut
        adipisci corrupti dolore officiis modi consequuntur illo animi dignissimos laudantium mollitia harum officia,
        ducimus deserunt quam veritatis quod totam itaque hic tempore suscipit tenetur quae a accusamus reprehenderit!
        Odio, porro culpa? Atque placeat nobis eum sapiente cumque esse consequatur nemo soluta vel. Odio quasi est
        libero! Sequi a odit deserunt est nihil rerum saepe libero delectus possimus, officia necessitatibus tempore
        quaerat optio qui aperiam ipsum nesciunt aliquid enim et impedit nostrum labore? Tenetur fugiat quas porro in ea
        iusto asperiores vero eius iure quasi.
    </blockquote>
</body>

</html>